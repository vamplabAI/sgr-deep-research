# Confluence Research Agent ‚Äî –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Open WebUI](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-open-webui)
- [API Reference](#api-reference)
- [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)
- [Troubleshooting](#troubleshooting)

## –û–±–∑–æ—Ä

**Confluence Research Agent** ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ Atlassian Confluence. –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Schema-Guided Reasoning (SGR) –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–∏–Ω—Ç–µ–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫** ‚Äî –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–π –±–∞–∑–µ Confluence –∏–ª–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö
- üìÑ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- üß† **Schema-Guided Reasoning** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- üí¨ **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–µ—Å–µ–¥—ã
- üîó **–°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏** ‚Äî –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã Confluence
- üåê **OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π REST API –¥–ª—è –ª–µ–≥–∫–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- üìä **Streaming –æ—Ç–≤–µ—Ç—ã** ‚Äî –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ê–≥–µ–Ω—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –±–∞–∑–µ SGR Agent Core –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤—É—Ö—Ñ–∞–∑–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

1. **–§–∞–∑–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è (Reasoning Phase)** ‚Äî –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
2. **–§–∞–∑–∞ –¥–µ–π—Å—Ç–≤–∏—è (Action Phase)** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Å–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    User Query                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Reasoning Phase (ReasoningTool)                 ‚îÇ
‚îÇ  ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞                                            ‚îÇ
‚îÇ  ‚Ä¢ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π                                     ‚îÇ
‚îÇ  ‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Action Phase (Tools Execution)                  ‚îÇ
‚îÇ  ‚Ä¢ ConfluenceFullTextSearchTool                              ‚îÇ
‚îÇ  ‚Ä¢ ConfluenceSpaceFullTextSearchTool                         ‚îÇ
‚îÇ  ‚Ä¢ ConfluencePageRetrievalTool                               ‚îÇ
‚îÇ  ‚Ä¢ CreateReportTool                                          ‚îÇ
‚îÇ  ‚Ä¢ FinalAnswerTool                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   Final Answer                               ‚îÇ
‚îÇ  ‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç                                   ‚îÇ
‚îÇ  ‚Ä¢ –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏                                       ‚îÇ
‚îÇ  ‚Ä¢ Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- uv (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ pip
- –î–æ—Å—Ç—É–ø –∫ Confluence API
- OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π LLM (OpenAI, Azure OpenAI, –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ LiteLLM)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

#### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/vamplabAI/sgr-deep-research.git
cd sgr-deep-research
```

#### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ò—Å–ø–æ–ª—å–∑—É—è uv (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
uv sync
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è pip:
```bash
pip install -e .
```

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
```bash
cp config.yaml.example config.yaml
cp agents.yaml.example agents.yaml
```

#### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞

```bash
uv run python sgr_deep_research
```

–ò–ª–∏:
```bash
python -m sgr_deep_research
```

–ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8020`

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `services/`:
```env
CONFLUENCE_BASE_URL=https://your-confluence.com
CONFLUENCE_USERNAME=your-email@company.com
CONFLUENCE_API_TOKEN=your-api-token
OPENAI_API_KEY=your-openai-key
```

#### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
cd services
docker compose up -d
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```bash
docker compose ps
docker compose logs -f
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
docker compose down
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.yaml

–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ LLM, Confluence –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

```yaml
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ LLM
llm:
  model: "gpt-4o-mini"  # –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  max_tokens: 8000       # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤
  temperature: 0.2       # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (0.0-1.0)
  base_url: null         # URL –¥–ª—è custom endpoint (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  api_key: null          # API –∫–ª—é—á (–∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Confluence
confluence:
  base_url: "https://your-confluence.com"
  username: "your-email@company.com"
  api_token: "your-api-token"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
```

### agents.yaml

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–º–ø—Ç–æ–≤.

```yaml
agents:
  - name: sgr_tool_calling_agent_confluence
    base_class: SGRToolCallingAgent
    tools:
      - ConfluenceFullTextSearchTool
      - ConfluenceSpaceFullTextSearchTool
      - ConfluencePageRetrievalTool
      - CreateReportTool
      - FinalAnswerTool
    execution:
      max_clarifications: 3
      max_iterations: 15
      mcp_context_limit: 15000
      logs_dir: "logs"
      reports_dir: "reports"
      max_searches: 4
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ config.yaml:

```bash
# LLM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
export OPENAI_API_KEY="your-key"
export OPENAI_BASE_URL="https://api.openai.com/v1"
export LLM_MODEL="gpt-4o-mini"

# Confluence –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
export CONFLUENCE_BASE_URL="https://your-confluence.com"
export CONFLUENCE_USERNAME="your-email@company.com"
export CONFLUENCE_API_TOKEN="your-token"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
export HOST="0.0.0.0"
export PORT="8020"
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ API

```python
import requests

# –ó–∞–ø—Ä–æ—Å –∫ –∞–≥–µ–Ω—Ç—É
response = requests.post(
    "http://localhost:8020/v1/chat/completions",
    json={
        "model": "sgr_tool_calling_agent_confluence",
        "messages": [
            {"role": "user", "content": "–ù–∞–π–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha"}
        ],
        "stream": True
    },
    stream=True
)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ streaming –æ—Ç–≤–µ—Ç–∞
for line in response.iter_lines():
    if line:
        print(line.decode('utf-8'))
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Python SDK

```python
from openai import OpenAI

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∞–≥–µ–Ω—Ç—É
client = OpenAI(
    base_url="http://localhost:8020/v1",
    api_key="dummy"  # API key –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
)

# –ó–∞–ø—Ä–æ—Å –∫ –∞–≥–µ–Ω—Ç—É
response = client.chat.completions.create(
    model="sgr_tool_calling_agent_confluence",
    messages=[
        {"role": "user", "content": "–ù–∞–π–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha"}
    ],
    stream=True
)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
for chunk in response:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="")
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Open WebUI

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–≥–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω:
```bash
curl http://localhost:8020/health
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Open WebUI

1. –û—Ç–∫—Ä–æ–π—Ç–µ Open WebUI –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Connections**
3. –ù–∞–∂–º–∏—Ç–µ **Add Connection**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è:
   - **Name:** Confluence Agent
   - **Base URL:** `http://localhost:8020/v1`
   - **API Key:** (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –∏–ª–∏ –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
5. –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 3: –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏

1. –í —á–∞—Ç–µ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
2. –ù–∞–π–¥–∏—Ç–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ `sgr_tool_calling_agent_confluence`
3. –ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥!

### –®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
- "–ù–∞–π–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha"
- "–ß—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å ID 123456?"
- "–ü–æ–∫–∞–∂–∏ –≤—Å–µ –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É Beta"
- "–ö–∞–∫–∏–µ –µ—Å—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ DEV?"

## API Reference

### Endpoints

#### GET /health
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞.

**Response:**
```json
{
  "status": "healthy",
  "version": "1.0.0"
}
```

#### GET /v1/models
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (–∞–≥–µ–Ω—Ç–æ–≤).

**Response:**
```json
{
  "data": [
    {
      "id": "sgr_tool_calling_agent_confluence",
      "object": "model",
      "created": 1234567890,
      "owned_by": "sgr-agent-core"
    }
  ],
  "object": "list"
}
```

#### POST /v1/chat/completions
–û—Å–Ω–æ–≤–Ω–æ–π endpoint –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∞–≥–µ–Ω—Ç–æ–º.

**Request:**
```json
{
  "model": "sgr_tool_calling_agent_confluence",
  "messages": [
    {"role": "user", "content": "–ù–∞–π–¥–∏ –ø—Ä–æ–µ–∫—Ç Alpha"}
  ],
  "stream": true,
  "max_tokens": 8000,
  "temperature": 0.2
}
```

**Response (streaming):**
```
data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1234567890,"model":"sgr_tool_calling_agent_confluence","choices":[{"index":0,"delta":{"content":"üîç"},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1234567890,"model":"sgr_tool_calling_agent_confluence","choices":[{"index":0,"delta":{"content":" –ò—â—É"},"finish_reason":null}]}

...

data: [DONE]
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

#### ConfluenceFullTextSearchTool
–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–π –±–∞–∑–µ Confluence.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` (string) ‚Äî –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `max_results` (int) ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (1-25)
- `content_type` (enum) ‚Äî —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞: "page", "blogpost", "attachment"
- `include_content` (bool) ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–≤—å—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (500 —Å–∏–º–≤–æ–ª–æ–≤)

#### ConfluenceSpaceFullTextSearchTool
–ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ Confluence.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` (string) ‚Äî –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `space_key` (string) ‚Äî –∫–ª—é—á –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- `max_results` (int) ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (1-25)
- `include_content` (bool) ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–≤—å—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### ConfluencePageRetrievalTool
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ ID.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page_id` (string) ‚Äî ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—á–∏—Å–ª–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
- `page_number` (int) ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—è —Å 1)
- `chunk_size` (int) ‚Äî —Ä–∞–∑–º–µ—Ä —á–∞—Å—Ç–∏ (1000-10000 —Å–∏–º–≤–æ–ª–æ–≤)

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫

**–ó–∞–ø—Ä–æ—Å:**
```
–ù–∞–π–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

**–û—Ç–≤–µ—Ç –∞–≥–µ–Ω—Ç–∞:**
```markdown
üîç –ò—â—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Confluence...

## üìÑ API –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- **OAuth 2.0** ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **API Token** ‚Äî –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **Basic Auth** ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- [API Authentication Guide](https://confluence.company.com/page/12345)
- [OAuth 2.0 Setup](https://confluence.company.com/page/67890)
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ

**–ó–∞–ø—Ä–æ—Å:**
```
–ü–æ–∫–∞–∂–∏ –≤—Å–µ –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ PROJ
```

**–û—Ç–≤–µ—Ç –∞–≥–µ–Ω—Ç–∞:**
```markdown
üîç –ò—â—É –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ PROJ...

## üìÖ –í—Å—Ç—Ä–µ—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É Alpha

–ù–∞–π–¥–µ–Ω–æ 5 –≤—Å—Ç—Ä–µ—á:

1. **2025-01-15 - Kickoff Meeting**
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏: 12 —á–µ–ª–æ–≤–µ–∫
   - [–°—Å—ã–ª–∫–∞](https://confluence.company.com/page/111)

2. **2025-01-22 - Sprint Planning**
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏: 8 —á–µ–ª–æ–≤–µ–∫
   - [–°—Å—ã–ª–∫–∞](https://confluence.company.com/page/222)

...
```

### –ü—Ä–∏–º–µ—Ä 3: –î–∏–∞–ª–æ–≥ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

**–î–∏–∞–ª–æ–≥:**
```
User: –ù–∞–π–¥–∏ –ø—Ä–æ–µ–∫—Ç Alpha
Agent: [–í—ã–¥–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ Alpha]

User: –ö—Ç–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞?
Agent: –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ Alpha, —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º —è–≤–ª—è–µ—Ç—Å—è –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤...

User: –°–ø–∞—Å–∏–±–æ
Agent: –ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ‚Äî –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å.
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–≥–µ–Ω—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Confluence
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API token –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Confluence

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `base_url` –≤ config.yaml
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Confluence –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ —Å–µ—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –∏ proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ `max_searches` –≤ agents.yaml
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å LLM
3. –£–≤–µ–ª–∏—á—å—Ç–µ `chunk_size` –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–≥–µ–Ω—Ç –Ω–µ –ø–æ–º–Ω–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ streaming mode
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –£–≤–µ–ª–∏—á—å—Ç–µ `mcp_context_limit` –≤ agents.yaml

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `logs/`:
```bash
tail -f logs/agent_*.log
```

–î–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å DEBUG –≤ `logging_config.yaml`:
```yaml
root:
  level: DEBUG
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Project Wiki](https://github.com/vamplabAI/sgr-deep-research/wiki)
- [API Documentation](https://github.com/vamplabAI/sgr-deep-research/wiki/SGR-Description-API)
- [Community Chat](https://t.me/sgragentcore)
- [GitHub Issues](https://github.com/vamplabAI/sgr-deep-research/issues)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](../LICENSE) —Ñ–∞–π–ª –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
